<!DOCTYPE html>
<!-- saved from url=(0122)https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#sphx-glr-beginner-nlp-word-embeddings-tutorial-py -->
<html class="js flexbox canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths gr__pytorch_org" lang="en" style=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta content="width=device-width, initial-scale=1.0" name="viewport">
<title>Word Embeddings: Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation</title>
<style class="anchorjs"></style><link href="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/theme.css" rel="stylesheet" type="text/css">
<!-- <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" /> -->
<link href="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/gallery.css" rel="stylesheet" type="text/css">
<link href="https://pytorch.org/tutorials/genindex.html" rel="index" title="Index">
<link href="https://pytorch.org/tutorials/search.html" rel="search" title="Search">
<link href="https://pytorch.org/tutorials/beginner/nlp/sequence_models_tutorial.html" rel="next" title="Sequence Models and Long-Short Term Memory Networks">
<link href="https://pytorch.org/tutorials/beginner/nlp/deep_learning_tutorial.html" rel="prev" title="Deep Learning with PyTorch">
<script async="" src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/analytics.js.下载"></script><script src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/modernizr.min.js.下载"></script>
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style></head>
<body class="pytorch-body" data-gr-c-s-loaded="true"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><div class="container-fluid header-holder tutorials-header" id="header-holder">
<div class="container">
<div class="header-container">
<a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/"></a>
<div class="main-menu">
<ul>
<li>
<a href="https://pytorch.org/get-started">Get Started</a>
</li>
<li>
<a href="https://pytorch.org/features">Features</a>
</li>
<li>
<a href="https://pytorch.org/ecosystem">Ecosystem</a>
</li>
<li>
<a href="https://pytorch.org/blog/">Blog</a>
</li>
<li class="active">
<a href="https://pytorch.org/tutorials">Tutorials</a>
</li>
<li>
<a href="https://pytorch.org/docs/stable/index.html">Docs</a>
</li>
<li>
<a href="https://pytorch.org/resources">Resources</a>
</li>
<li>
<a href="https://github.com/pytorch/pytorch">Github</a>
</li>
</ul>
</div>
<a class="main-menu-open-button" data-behavior="open-mobile-menu" href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#"></a>
</div>
</div>
</div>

<div class="table-of-contents-link-wrapper">
<span>Table of Contents</span>
<a class="toggle-table-of-contents" data-behavior="toggle-table-of-contents" href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#"></a>
</div>
<nav class="pytorch-left-menu" data-toggle="wy-nav-shift" id="pytorch-left-menu" style="height: 100%;">
<div class="pytorch-side-scroll">
<div aria-label="main navigation" class="pytorch-menu pytorch-menu-vertical" data-spy="affix" role="navigation">
<div class="pytorch-left-menu-search">
<div class="version">
                  1.0.0.dev20181207
                </div>
<div role="search">
<form action="https://pytorch.org/tutorials/search.html" class="wy-form" id="rtd-search-form" method="get">
<input name="q" placeholder="Search Tutorials" type="text">
<input name="check_keywords" type="hidden" value="yes">
<input name="area" type="hidden" value="default">
</form>
</div>
</div>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html">Deep Learning with PyTorch: A 60 Minute Blitz</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/data_loading_tutorial.html">Data Loading and Processing Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/pytorch_with_examples.html">Learning PyTorch with Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/transfer_learning_tutorial.html">Transfer Learning Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/deploy_seq2seq_hybrid_frontend_tutorial.html">Deploying a Seq2Seq Model with the Hybrid Frontend</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/saving_loading_models.html">Saving and Loading Models</a></li>
</ul>
<p class="caption"><span class="caption-text">Image</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/finetuning_torchvision_models_tutorial.html">Finetuning Torchvision Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/intermediate/spatial_transformer_tutorial.html">Spatial Transformer Networks Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/advanced/neural_style_tutorial.html">Neural Transfer Using PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/fgsm_tutorial.html">Adversarial Example Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/advanced/super_resolution_with_caffe2.html">Transfering a Model from PyTorch to Caffe2 and Mobile using ONNX</a></li>
</ul>
<p class="caption"><span class="caption-text">Text</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/chatbot_tutorial.html">Chatbot Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/intermediate/char_rnn_generation_tutorial.html">Generating Names with a Character-Level RNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/intermediate/char_rnn_classification_tutorial.html">Classifying Names with a Character-Level RNN</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/deep_learning_nlp_tutorial.html">Deep Learning for NLP with Pytorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/intermediate/seq2seq_translation_tutorial.html">Translation with a Sequence to Sequence Network and Attention</a></li>
</ul>
<p class="caption"><span class="caption-text">Generative</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/beginner/dcgan_faces_tutorial.html">DCGAN Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Reinforcement Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/intermediate/reinforcement_q_learning.html">Reinforcement Learning (DQN) Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Extending PyTorch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/advanced/numpy_extensions_tutorial.html">Creating Extensions Using numpy and scipy</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/advanced/cpp_extension.html">Custom C++ and CUDA Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/advanced/torch_script_custom_ops.html">Extending TorchScript with Custom C++ Operators</a></li>
</ul>
<p class="caption"><span class="caption-text">Production Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/intermediate/dist_tuto.html">Writing Distributed Applications with PyTorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/advanced/ONNXLive.html">ONNX Live Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="https://pytorch.org/tutorials/advanced/cpp_export.html">Loading a PyTorch Model in C++</a></li>
</ul>
</div>
</div>
</nav>
<div class="pytorch-container">
<div class="pytorch-page-level-bar" id="pytorch-page-level-bar">
<div class="pytorch-breadcrumbs-wrapper">
<div aria-label="breadcrumbs navigation" role="navigation">
<ul class="pytorch-breadcrumbs">
<li>
<a href="https://pytorch.org/tutorials/index.html">
          
            Tutorials
          
        </a> &gt;
      </li>
<li><a href="https://pytorch.org/tutorials/beginner/deep_learning_nlp_tutorial.html">Deep Learning for NLP with Pytorch</a> &gt;</li>
<li>Word Embeddings: Encoding Lexical Semantics</li>
<li class="pytorch-breadcrumbs-aside">
<a href="https://pytorch.org/tutorials/_sources/beginner/nlp/word_embeddings_tutorial.rst.txt" rel="nofollow"><img src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/view-page-source-icon.svg"></a>
</li>
</ul>
</div>
</div>
<div class="pytorch-shortcuts-wrapper" id="pytorch-shortcuts-wrapper" style="display: block;">
          Shortcuts
        </div>
</div>
<section class="pytorch-content-wrap" data-toggle="wy-nav-shift" id="pytorch-content-wrap">
<div class="pytorch-content-left">
<div class="rst-content">
<div class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<article class="pytorch-article" id="pytorch-article" itemprop="articleBody">
<div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#sphx-glr-download-beginner-nlp-word-embeddings-tutorial-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="word-embeddings-encoding-lexical-semantics">
<span id="sphx-glr-beginner-nlp-word-embeddings-tutorial-py"></span><h1>Word Embeddings: Encoding Lexical Semantics<a class="anchorjs-link " href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#word-embeddings-encoding-lexical-semantics" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em/1 anchorjs-icons; padding-left: 0.375em;"></a></h1>
<p>Word embeddings are dense vectors of real numbers, one per word in your
vocabulary. In NLP, it is almost always the case that your features are
words! But how should you represent a word in a computer? You could
store its ascii character representation, but that only tells you what
the word <em>is</em>, it doesn’t say much about what it <em>means</em> (you might be
able to derive its part of speech from its affixes, or properties from
its capitalization, but not much). Even more, in what sense could you
combine these representations? We often want dense outputs from our
neural networks, where the inputs are <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.727em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.328em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.088em, 1001.21em, 2.77em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="texatom" id="MathJax-Span-3"><span class="mrow" id="MathJax-Span-4"><span class="mo" id="MathJax-Span-5" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.246em;"></span></span><span class="texatom" id="MathJax-Span-7"><span class="mrow" id="MathJax-Span-8"><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1">|V|</script></span> dimensional, where
<span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 0.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.088em, 1000.85em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.246em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">V</script></span> is our vocabulary, but often the outputs are only a few
dimensional (if we are only predicting a handful of labels, for
instance). How do we get from a massive dimensional space to a smaller
dimensional space?</p>
<p>How about instead of ascii representations, we use a one-hot encoding?
That is, we represent the word <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 0.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.328em, 1000.73em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">w</script></span> by</p>
<div class="math notranslate nohighlight">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mtext&gt;|V| elements&lt;/mtext&gt;&lt;/mover&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 4.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.54em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(-0.956em, 1008.54em, 2.891em, -999.994em); top: -2.278em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="munderover" id="MathJax-Span-18"><span style="display: inline-block; position: relative; width: 8.059em; height: 0px;"><span style="position: absolute; clip: rect(2.049em, 1008.06em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="texatom" id="MathJax-Span-19"><span class="mrow" id="MathJax-Span-20"><span class="munderover" id="MathJax-Span-21"><span style="display: inline-block; position: relative; width: 8.059em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1007.94em, 4.573em, -999.994em); top: -3.96em; left: 0.006em;"><span class="mrow" id="MathJax-Span-22"><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">[</span><span class="mrow" id="MathJax-Span-24"><span class="mn" id="MathJax-Span-25" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.126em;">0</span><span class="mo" id="MathJax-Span-28" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main; padding-left: 0.126em;">…</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.126em;">,</span><span class="mn" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.126em;">1</span><span class="mo" id="MathJax-Span-32" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.126em;">…</span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.126em;">,</span><span class="mn" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.126em;">0</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-37" style="font-family: MathJax_Main; padding-left: 0.126em;">0</span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">]</span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.65em, 1008.06em, 3.972em, -999.994em); top: -4.681em; left: 0em;"><span class="mo" id="MathJax-Span-39" style=""><span style="display: inline-block; position: relative; width: 8.059em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.006em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 7.578em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 3.612em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 0.367em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 0.727em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 1.088em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 1.448em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 1.809em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 2.169em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 2.53em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 2.891em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 3.251em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 4.453em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 4.814em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 5.174em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 5.535em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 5.895em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 6.256em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 6.617em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 6.977em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 7.338em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.371em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.77em, 1005.05em, 4.573em, -999.994em); top: -6.004em; left: 1.448em;"><span class="mtext" id="MathJax-Span-40" style="font-size: 96.2%; font-family: MathJax_Main;">|V| elements</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.29em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><mo>[</mo><mrow><mn>0</mn><mo>,</mo><mn>0</mn><mo>,</mo><mo>…</mo><mo>,</mo><mn>1</mn><mo>,</mo><mo>…</mo><mo>,</mo><mn>0</mn><mo>,</mo><mn>0</mn></mrow><mo>]</mo></mrow><mo>⏞</mo></mover></mrow><mtext>|V| elements</mtext></mover></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">\overbrace{\left[ 0, 0, \dots, 1, \dots, 0, 0 \right]}^\text{|V| elements}</script></div>
<p>where the 1 is in a location unique to <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-41" style="width: 0.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.328em, 1000.73em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">w</script></span>. Any other word will
have a 1 in some other location, and a 0 everywhere else.</p>
<p>There is an enormous drawback to this representation, besides just how
huge it is. It basically treats all words as independent entities with
no relation to each other. What we really want is some notion of
<em>similarity</em> between words. Why? Let’s see an example.</p>
<p>Suppose we are building a language model. Suppose we have seen the
sentences</p>
<ul class="simple">
<li>The mathematician ran to the store.</li>
<li>The physicist ran to the store.</li>
<li>The mathematician solved the open problem.</li>
</ul>
<p>in our training data. Now suppose we get a new sentence never before
seen in our training data:</p>
<ul class="simple">
<li>The physicist solved the open problem.</li>
</ul>
<p>Our language model might do OK on this sentence, but wouldn’t it be much
better if we could use the following two facts:</p>
<ul class="simple">
<li>We have seen  mathematician and physicist in the same role in a sentence. Somehow they
have a semantic relation.</li>
<li>We have seen mathematician in the same role  in this new unseen sentence
as we are now seeing physicist.</li>
</ul>
<p>and then infer that physicist is actually a good fit in the new unseen
sentence? This is what we mean by a notion of similarity: we mean
<em>semantic similarity</em>, not simply having similar orthographic
representations. It is a technique to combat the sparsity of linguistic
data, by connecting the dots between what we have seen and what we
haven’t. This example of course relies on a fundamental linguistic
assumption: that words appearing in similar contexts are related to each
other semantically. This is called the <a class="reference external" href="https://en.wikipedia.org/wiki/Distributional_semantics">distributional
hypothesis</a>.</p>
<div class="section" id="getting-dense-word-embeddings">
<h2>Getting Dense Word Embeddings<a class="anchorjs-link " href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#getting-dense-word-embeddings" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em/1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>How can we solve this problem? That is, how could we actually encode
semantic similarity in words? Maybe we think up some semantic
attributes. For example, we see that both mathematicians and physicists
can run, so maybe we give these words a high score for the “is able to
run” semantic attribute. Think of some other attributes, and imagine
what you might score some common words on those attributes.</p>
<p>If each attribute is a dimension, then we might give each word a vector,
like this:</p>
<div class="math notranslate nohighlight">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mtext&gt;mathematician&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mn&gt;2.3&lt;/mn&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mtext&gt;can run&lt;/mtext&gt;&lt;/mover&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mn&gt;9.4&lt;/mn&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mtext&gt;likes coffee&lt;/mtext&gt;&lt;/mover&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;5.5&lt;/mn&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mtext&gt;majored in Physics&lt;/mtext&gt;&lt;/mover&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-44" style="width: 14.91em; display: inline-block;"><span style="display: inline-block; position: relative; width: 28.732em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(2.169em, 1028.37em, 7.698em, -999.994em); top: -5.162em; left: 0em;"><span class="mrow" id="MathJax-Span-45"><span class="msubsup" id="MathJax-Span-46"><span style="display: inline-block; position: relative; width: 6.737em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-47" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.487em;"><span class="mtext" id="MathJax-Span-48" style="font-size: 96.2%; font-family: MathJax_Main;">mathematician</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main; padding-left: 0.246em;">=</span><span class="mrow" id="MathJax-Span-50" style="padding-left: 0.246em;"><span class="mo" id="MathJax-Span-51" style="vertical-align: 2.65em;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.758em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.246em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.677em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.196em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.835em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mrow" id="MathJax-Span-52"><span class="munderover" id="MathJax-Span-53"><span style="display: inline-block; position: relative; width: 3.131em; height: 0px;"><span style="position: absolute; clip: rect(2.049em, 1001.69em, 4.333em, -999.994em); top: -3.96em; left: 0.727em;"><span class="texatom" id="MathJax-Span-54"><span class="mrow" id="MathJax-Span-55"><span class="munderover" id="MathJax-Span-56"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1001.21em, 4.333em, -999.994em); top: -3.96em; left: 0.246em;"><span class="mn" id="MathJax-Span-57" style="font-family: MathJax_Main;">2.3</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.65em, 1001.69em, 3.972em, -999.994em); top: -4.561em; left: 0em;"><span class="mo" id="MathJax-Span-58" style=""><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.006em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 1.208em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.367em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.371em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.131em, 1003.13em, 4.333em, -999.994em); top: -5.643em; left: 0em;"><span class="mtext" id="MathJax-Span-59" style="font-size: 96.2%; font-family: MathJax_Main;">can run</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-60" style="font-family: MathJax_Main;">,</span><span class="munderover" id="MathJax-Span-61" style="padding-left: 0.126em;"><span style="display: inline-block; position: relative; width: 4.453em; height: 0px;"><span style="position: absolute; clip: rect(2.049em, 1001.69em, 4.333em, -999.994em); top: -3.96em; left: 1.448em;"><span class="texatom" id="MathJax-Span-62"><span class="mrow" id="MathJax-Span-63"><span class="munderover" id="MathJax-Span-64"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1001.21em, 4.333em, -999.994em); top: -3.96em; left: 0.246em;"><span class="mn" id="MathJax-Span-65" style="font-family: MathJax_Main;">9.4</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.65em, 1001.69em, 3.972em, -999.994em); top: -4.561em; left: 0em;"><span class="mo" id="MathJax-Span-66" style=""><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.006em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 1.208em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.367em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.371em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.891em, 1004.45em, 4.333em, -999.994em); top: -5.643em; left: 0em;"><span class="mtext" id="MathJax-Span-67" style="font-size: 96.2%; font-family: MathJax_Main;">likes coffee</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">,</span><span class="munderover" id="MathJax-Span-69" style="padding-left: 0.126em;"><span style="display: inline-block; position: relative; width: 7.819em; height: 0px;"><span style="position: absolute; clip: rect(2.049em, 1002.05em, 4.453em, -999.994em); top: -3.96em; left: 2.891em;"><span class="texatom" id="MathJax-Span-70"><span class="mrow" id="MathJax-Span-71"><span class="munderover" id="MathJax-Span-72"><span style="display: inline-block; position: relative; width: 2.049em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1002.05em, 4.453em, -999.994em); top: -3.96em; left: 0.006em;"><span class="mrow" id="MathJax-Span-73"><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-75" style="font-family: MathJax_Main;">5.5</span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.65em, 1002.05em, 3.972em, -999.994em); top: -4.561em; left: 0em;"><span class="mo" id="MathJax-Span-76" style=""><span style="display: inline-block; position: relative; width: 2.049em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.006em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 1.569em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.607em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 0.367em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -3.96em; left: 1.328em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.371em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.891em, 1007.82em, 4.573em, -999.994em); top: -5.883em; left: 0em;"><span class="mtext" id="MathJax-Span-77" style="font-size: 96.2%; font-family: MathJax_Main;">majored in Physics</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-78" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.126em;">…</span></span><span class="mo" id="MathJax-Span-80" style="vertical-align: 2.65em;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.758em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.246em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.677em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.196em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.835em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.174em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>q</mi><mtext>mathematician</mtext></msub><mo>=</mo><mrow><mo>[</mo><mrow><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mn>2.3</mn><mo>⏞</mo></mover></mrow><mtext>can run</mtext></mover><mo>,</mo><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mn>9.4</mn><mo>⏞</mo></mover></mrow><mtext>likes coffee</mtext></mover><mo>,</mo><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mrow><mo>−</mo><mn>5.5</mn></mrow><mo>⏞</mo></mover></mrow><mtext>majored in Physics</mtext></mover><mo>,</mo><mo>…</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-6"> q_\text{mathematician} = \left[ \overbrace{2.3}^\text{can run},
\overbrace{9.4}^\text{likes coffee}, \overbrace{-5.5}^\text{majored in Physics}, \dots \right]</script></div>
<div class="math notranslate nohighlight">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mtext&gt;physicist&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mrow&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mn&gt;2.5&lt;/mn&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mtext&gt;can run&lt;/mtext&gt;&lt;/mover&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mn&gt;9.1&lt;/mn&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mtext&gt;likes coffee&lt;/mtext&gt;&lt;/mover&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mover&gt;&lt;mrow class=&quot;MJX-TeXAtom-OP MJX-fixedlimits&quot;&gt;&lt;mover&gt;&lt;mn&gt;6.4&lt;/mn&gt;&lt;mo&gt;&amp;#x23DE;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mtext&gt;majored in Physics&lt;/mtext&gt;&lt;/mover&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 13.588em; display: inline-block;"><span style="display: inline-block; position: relative; width: 26.088em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(2.169em, 1025.73em, 7.698em, -999.994em); top: -5.162em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="msubsup" id="MathJax-Span-83"><span style="display: inline-block; position: relative; width: 4.213em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.487em;"><span class="mtext" id="MathJax-Span-85" style="font-size: 96.2%; font-family: MathJax_Main;">physicist</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.246em;">=</span><span class="mrow" id="MathJax-Span-87" style="padding-left: 0.246em;"><span class="mo" id="MathJax-Span-88" style="vertical-align: 2.65em;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.758em; left: 0em;">⎡<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.246em; left: 0em;">⎣<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.677em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.196em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.835em; left: 0em;">⎢<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mrow" id="MathJax-Span-89"><span class="munderover" id="MathJax-Span-90"><span style="display: inline-block; position: relative; width: 3.131em; height: 0px;"><span style="position: absolute; clip: rect(2.049em, 1001.69em, 4.333em, -999.994em); top: -3.96em; left: 0.727em;"><span class="texatom" id="MathJax-Span-91"><span class="mrow" id="MathJax-Span-92"><span class="munderover" id="MathJax-Span-93"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1001.21em, 4.333em, -999.994em); top: -3.96em; left: 0.246em;"><span class="mn" id="MathJax-Span-94" style="font-family: MathJax_Main;">2.5</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.65em, 1001.69em, 3.972em, -999.994em); top: -4.561em; left: 0em;"><span class="mo" id="MathJax-Span-95" style=""><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.006em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 1.208em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.367em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.371em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(3.131em, 1003.13em, 4.333em, -999.994em); top: -5.643em; left: 0em;"><span class="mtext" id="MathJax-Span-96" style="font-size: 96.2%; font-family: MathJax_Main;">can run</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main;">,</span><span class="munderover" id="MathJax-Span-98" style="padding-left: 0.126em;"><span style="display: inline-block; position: relative; width: 4.453em; height: 0px;"><span style="position: absolute; clip: rect(2.049em, 1001.69em, 4.333em, -999.994em); top: -3.96em; left: 1.448em;"><span class="texatom" id="MathJax-Span-99"><span class="mrow" id="MathJax-Span-100"><span class="munderover" id="MathJax-Span-101"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1001.21em, 4.333em, -999.994em); top: -3.96em; left: 0.246em;"><span class="mn" id="MathJax-Span-102" style="font-family: MathJax_Main;">9.1</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.65em, 1001.69em, 3.972em, -999.994em); top: -4.561em; left: 0em;"><span class="mo" id="MathJax-Span-103" style=""><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.006em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 1.208em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.367em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.371em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.891em, 1004.45em, 4.333em, -999.994em); top: -5.643em; left: 0em;"><span class="mtext" id="MathJax-Span-104" style="font-size: 96.2%; font-family: MathJax_Main;">likes coffee</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-105" style="font-family: MathJax_Main;">,</span><span class="munderover" id="MathJax-Span-106" style="padding-left: 0.126em;"><span style="display: inline-block; position: relative; width: 7.819em; height: 0px;"><span style="position: absolute; clip: rect(2.049em, 1001.69em, 4.333em, -999.994em); top: -3.96em; left: 3.131em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="munderover" id="MathJax-Span-109"><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1001.21em, 4.333em, -999.994em); top: -3.96em; left: 0.246em;"><span class="mn" id="MathJax-Span-110" style="font-family: MathJax_Main;">6.4</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.65em, 1001.69em, 3.972em, -999.994em); top: -4.561em; left: 0em;"><span class="mo" id="MathJax-Span-111" style=""><span style="display: inline-block; position: relative; width: 1.689em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.006em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 1.208em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: -3.96em; left: 0.367em;"><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.371em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.891em, 1007.82em, 4.573em, -999.994em); top: -5.883em; left: 0em;"><span class="mtext" id="MathJax-Span-112" style="font-size: 96.2%; font-family: MathJax_Main;">majored in Physics</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-113" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main; padding-left: 0.126em;">…</span></span><span class="mo" id="MathJax-Span-115" style="vertical-align: 2.65em;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.758em; left: 0em;">⎤<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.246em; left: 0em;">⎦<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.677em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.196em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.835em; left: 0em;">⎥<span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.174em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.184em; border-left: 0px solid; width: 0px; height: 2.628em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>q</mi><mtext>physicist</mtext></msub><mo>=</mo><mrow><mo>[</mo><mrow><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mn>2.5</mn><mo>⏞</mo></mover></mrow><mtext>can run</mtext></mover><mo>,</mo><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mn>9.1</mn><mo>⏞</mo></mover></mrow><mtext>likes coffee</mtext></mover><mo>,</mo><mover><mrow class="MJX-TeXAtom-OP MJX-fixedlimits"><mover><mn>6.4</mn><mo>⏞</mo></mover></mrow><mtext>majored in Physics</mtext></mover><mo>,</mo><mo>…</mo></mrow><mo>]</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-7"> q_\text{physicist} = \left[ \overbrace{2.5}^\text{can run},
\overbrace{9.1}^\text{likes coffee}, \overbrace{6.4}^\text{majored in Physics}, \dots \right]</script></div>
<p>Then we can get a measure of similarity between these words by doing:</p>
<div class="math notranslate nohighlight">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;Similarity&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mtext&gt;physicist&lt;/mtext&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;mathematician&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mtext&gt;physicist&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mtext&gt;mathematician&lt;/mtext&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-116" style="width: 15.871em; display: inline-block;"><span style="display: inline-block; position: relative; width: 30.415em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.208em, 1030.41em, 3.131em, -999.994em); top: -2.278em; left: 0em;"><span class="mrow" id="MathJax-Span-117"><span class="mtext" id="MathJax-Span-118" style="font-family: MathJax_Main;">Similarity</span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-120" style="font-family: MathJax_Main;">physicist</span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.126em;">mathematician</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-124" style="font-family: MathJax_Main; padding-left: 0.246em;">=</span><span class="msubsup" id="MathJax-Span-125" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 4.213em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.487em;"><span class="mtext" id="MathJax-Span-127" style="font-size: 96.2%; font-family: MathJax_Main;">physicist</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-128" style="font-family: MathJax_Main; padding-left: 0.246em;">⋅</span><span class="msubsup" id="MathJax-Span-129" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 6.737em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.487em;"><span class="mtext" id="MathJax-Span-131" style="font-size: 96.2%; font-family: MathJax_Main;">mathematician</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.29em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.816em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Similarity</mtext><mo stretchy="false">(</mo><mtext>physicist</mtext><mo>,</mo><mtext>mathematician</mtext><mo stretchy="false">)</mo><mo>=</mo><msub><mi>q</mi><mtext>physicist</mtext></msub><mo>⋅</mo><msub><mi>q</mi><mtext>mathematician</mtext></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-8">\text{Similarity}(\text{physicist}, \text{mathematician}) = q_\text{physicist} \cdot q_\text{mathematician}</script></div>
<p>Although it is more common to normalize by the lengths:</p>
<div class="math notranslate nohighlight">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtext&gt;Similarity&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mtext&gt;physicist&lt;/mtext&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mtext&gt;mathematician&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mtext&gt;physicist&lt;/mtext&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mtext&gt;mathematician&lt;/mtext&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mtext&gt;\physicist&lt;/mtext&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mtext&gt;mathematician&lt;/mtext&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;&amp;#x2016;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;cos&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-132" style="width: 19.237em; display: inline-block;"><span style="display: inline-block; position: relative; width: 36.905em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(0.367em, 1036.79em, 4.213em, -999.994em); top: -2.278em; left: 0em;"><span class="mrow" id="MathJax-Span-133"><span class="mtext" id="MathJax-Span-134" style="font-family: MathJax_Main;">Similarity</span><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">(</span><span class="mtext" id="MathJax-Span-136" style="font-family: MathJax_Main;">physicist</span><span class="mo" id="MathJax-Span-137" style="font-family: MathJax_Main;">,</span><span class="mtext" id="MathJax-Span-138" style="font-family: MathJax_Main; padding-left: 0.126em;">mathematician</span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-140" style="font-family: MathJax_Main; padding-left: 0.246em;">=</span><span class="mfrac" id="MathJax-Span-141" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 13.588em; height: 0px; margin-right: 0.126em; margin-left: 0.126em;"><span style="position: absolute; clip: rect(3.131em, 1011.78em, 4.814em, -999.994em); top: -5.162em; left: 50%; margin-left: -5.883em;"><span class="mrow" id="MathJax-Span-142"><span class="msubsup" id="MathJax-Span-143"><span style="display: inline-block; position: relative; width: 4.213em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-144" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.487em;"><span class="mtext" id="MathJax-Span-145" style="font-size: 96.2%; font-family: MathJax_Main;">physicist</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-146" style="font-family: MathJax_Main; padding-left: 0.246em;">⋅</span><span class="msubsup" id="MathJax-Span-147" style="padding-left: 0.246em;"><span style="display: inline-block; position: relative; width: 6.737em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.487em;"><span class="mtext" id="MathJax-Span-149" style="font-size: 96.2%; font-family: MathJax_Main;">mathematician</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.891em, 1013.35em, 4.934em, -999.994em); top: -3.119em; left: 50%; margin-left: -6.725em;"><span class="mrow" id="MathJax-Span-150"><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">∥</span><span class="msubsup" id="MathJax-Span-152"><span style="display: inline-block; position: relative; width: 4.694em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.487em;"><span class="mtext" id="MathJax-Span-154" style="font-size: 96.2%; font-family: MathJax_Main;">\physicist</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main;">∥</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main;">∥</span><span class="msubsup" id="MathJax-Span-157"><span style="display: inline-block; position: relative; width: 6.737em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.487em;"><span class="mtext" id="MathJax-Span-159" style="font-size: 96.2%; font-family: MathJax_Main;">mathematician</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-160" style="font-family: MathJax_Main;">∥</span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(0.727em, 1013.59em, 1.569em, -999.994em); top: -1.436em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 13.588em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.208em;"></span></span></span></span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main; padding-left: 0.246em;">=</span><span class="mi" id="MathJax-Span-162" style="font-family: MathJax_Main; padding-left: 0.246em;">cos</span><span class="mo" id="MathJax-Span-163"></span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-165" style="font-family: MathJax_Math-italic;">ϕ</span><span class="mo" id="MathJax-Span-166" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.29em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.872em; border-left: 0px solid; width: 0px; height: 1.753em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>Similarity</mtext><mo stretchy="false">(</mo><mtext>physicist</mtext><mo>,</mo><mtext>mathematician</mtext><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><msub><mi>q</mi><mtext>physicist</mtext></msub><mo>⋅</mo><msub><mi>q</mi><mtext>mathematician</mtext></msub></mrow><mrow><mo fence="false" stretchy="false">‖</mo><msub><mi>q</mi><mtext>\physicist</mtext></msub><mo fence="false" stretchy="false">‖</mo><mo fence="false" stretchy="false">‖</mo><msub><mi>q</mi><mtext>mathematician</mtext></msub><mo fence="false" stretchy="false">‖</mo></mrow></mfrac><mo>=</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>ϕ</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-9"> \text{Similarity}(\text{physicist}, \text{mathematician}) = \frac{q_\text{physicist} \cdot q_\text{mathematician}}
{\| q_\text{\physicist} \| \| q_\text{mathematician} \|} = \cos (\phi)</script></div>
<p>Where <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03D5;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-167" style="width: 0.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.607em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.088em, 1000.61em, 2.77em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math-italic;">ϕ</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>ϕ</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">\phi</script></span> is the angle between the two vectors. That way,
extremely similar words (words whose embeddings point in the same
direction) will have similarity 1. Extremely dissimilar words should
have similarity -1.</p>
<p>You can think of the sparse one-hot vectors from the beginning of this
section as a special case of these new vectors we have defined, where
each word basically has similarity 0, and we gave each word some unique
semantic attribute. These new vectors are <em>dense</em>, which is to say their
entries are (typically) non-zero.</p>
<p>But these new vectors are a big pain: you could think of thousands of
different semantic attributes that might be relevant to determining
similarity, and how on earth would you set the values of the different
attributes? Central to the idea of deep learning is that the neural
network learns representations of the features, rather than requiring
the programmer to design them herself. So why not just let the word
embeddings be parameters in our model, and then be updated during
training? This is exactly what we will do. We will have some <em>latent
semantic attributes</em> that the network can, in principle, learn. Note
that the word embeddings will probably not be interpretable. That is,
although with our hand-crafted vectors above we can see that
mathematicians and physicists are similar in that they both like coffee,
if we allow a neural network to learn the embeddings and see that both
mathematicians and physicists have a large value in the second
dimension, it is not clear what that means. They are similar in some
latent semantic dimension, but this probably has no interpretation to
us.</p>
<p>In summary, <strong>word embeddings are a representation of the *semantics* of
a word, efficiently encoding semantic information that might be relevant
to the task at hand</strong>. You can embed other things too: part of speech
tags, parse trees, anything! The idea of feature embeddings is central
to the field.</p>
</div>
<div class="section" id="word-embeddings-in-pytorch">
<h2>Word Embeddings in Pytorch<a class="anchorjs-link " href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#word-embeddings-in-pytorch" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em/1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Before we get to a worked example and an exercise, a few quick notes
about how to use embeddings in Pytorch and in deep learning programming
in general. Similar to how we defined a unique index for each word when
making one-hot vectors, we also need to define an index for each word
when using embeddings. These will be keys into a lookup table. That is,
embeddings are stored as a <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-170" style="width: 1.809em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.492em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.088em, 1003.49em, 2.77em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-171"><span class="texatom" id="MathJax-Span-172"><span class="mrow" id="MathJax-Span-173"><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.246em;"></span></span><span class="texatom" id="MathJax-Span-176"><span class="mrow" id="MathJax-Span-177"><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main;">|</span></span></span><span class="mo" id="MathJax-Span-179" style="font-family: MathJax_Main; padding-left: 0.246em;">×</span><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math-italic; padding-left: 0.246em;">D</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>V</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mo>×</mo><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">|V| \times D</script></span> matrix, where <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;D&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-181" style="width: 0.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.847em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.088em, 1000.85em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-182"><span class="mi" id="MathJax-Span-183" style="font-family: MathJax_Math-italic;">D</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>D</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">D</script></span>
is the dimensionality of the embeddings, such that the word assigned
index <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-184" style="width: 0.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.208em, 1000.37em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-185"><span class="mi" id="MathJax-Span-186" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">i</script></span> has its embedding stored in the <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-187" style="width: 0.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.367em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.208em, 1000.37em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-188"><span class="mi" id="MathJax-Span-189" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">i</script></span>’th row of the
matrix. In all of my code, the mapping from words to indices is a
dictionary named word_to_ix.</p>
<p>The module that allows you to use embeddings is torch.nn.Embedding,
which takes two arguments: the vocabulary size, and the dimensionality
of the embeddings.</p>
<p>To index into this table, you must use torch.LongTensor (since the
indices are integers, not floats).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Robert Guthrie</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="kn">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="kn">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torch.optim</span> <span class="kn">as</span> <span class="nn">optim</span>

<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">word_to_ix</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"hello"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"world"</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="n">embeds</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># 2 words in vocab, 5 dimensional embeddings</span>
<span class="n">lookup_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">word_to_ix</span><span class="p">[</span><span class="s2">"hello"</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>
<span class="n">hello_embed</span> <span class="o">=</span> <span class="n">embeds</span><span class="p">(</span><span class="n">lookup_tensor</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">hello_embed</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>tensor([[ 0.6614,  0.2669,  0.0617,  0.6213, -0.4519]],
       grad_fn=&lt;EmbeddingBackward&gt;)
</pre></div>
</div>
</div>
<div class="section" id="an-example-n-gram-language-modeling">
<h2>An Example: N-Gram Language Modeling<a class="anchorjs-link " href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#an-example-n-gram-language-modeling" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em/1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Recall that in an n-gram language model, given a sequence of words
<span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-190" style="width: 0.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.328em, 1000.73em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-191"><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">w</script></span>, we want to compute</p>
<div class="math notranslate nohighlight">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-193" style="width: 7.698em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.669em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.208em, 1014.55em, 3.011em, -999.994em); top: -2.278em; left: 0em;"><span class="mrow" id="MathJax-Span-194"><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.126em;"></span></span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-197"><span style="display: inline-block; position: relative; width: 1.088em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.72em; left: 0.727em;"><span class="mi" id="MathJax-Span-199" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="mo" id="MathJax-Span-202" style="font-family: MathJax_Main;">|</span></span></span><span class="msubsup" id="MathJax-Span-203"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.72em; left: 0.727em;"><span class="texatom" id="MathJax-Span-205"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-208" style="font-size: 96.2%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-209" style="font-size: 96.2%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-211" style="padding-left: 0.126em;"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.72em; left: 0.727em;"><span class="texatom" id="MathJax-Span-213"><span class="mrow" id="MathJax-Span-214"><span class="mi" id="MathJax-Span-215" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-216" style="font-size: 96.2%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-217" style="font-size: 96.2%; font-family: MathJax_Main;">2</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-219" style="font-family: MathJax_Main; padding-left: 0.126em;">…</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main; padding-left: 0.126em;">,</span><span class="msubsup" id="MathJax-Span-221" style="padding-left: 0.126em;"><span style="display: inline-block; position: relative; width: 3.732em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.72em; left: 0.727em;"><span class="texatom" id="MathJax-Span-223"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-226" style="font-size: 96.2%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-227" style="font-size: 96.2%; font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-228" style="font-size: 96.2%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-229" style="font-size: 96.2%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-230" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.29em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-16">P(w_i | w_{i-1}, w_{i-2}, \dots, w_{i-n+1} )</script></div>
<p>Where <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-231" style="width: 0.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.088em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.328em, 1001.09em, 2.891em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-232"><span class="msubsup" id="MathJax-Span-233"><span style="display: inline-block; position: relative; width: 1.088em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.72em; left: 0.727em;"><span class="mi" id="MathJax-Span-235" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-17">w_i</script></span> is the ith word of the sequence.</p>
<p>In this example, we will compute the loss function on some training
examples and update the parameters with backpropagation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CONTEXT_SIZE</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">EMBEDDING_DIM</span> <span class="o">=</span> <span class="mi">10</span>
<span class="c1"># We will use Shakespeare Sonnet 2</span>
<span class="n">test_sentence</span> <span class="o">=</span> <span class="s2">"""When forty winters shall besiege thy brow,</span>
<span class="s2">And dig deep trenches in thy beauty's field,</span>
<span class="s2">Thy youth's proud livery so gazed on now,</span>
<span class="s2">Will be a totter'd weed of small worth held:</span>
<span class="s2">Then being asked, where all thy beauty lies,</span>
<span class="s2">Where all the treasure of thy lusty days;</span>
<span class="s2">To say, within thine own deep sunken eyes,</span>
<span class="s2">Were an all-eating shame, and thriftless praise.</span>
<span class="s2">How much more praise deserv'd thy beauty's use,</span>
<span class="s2">If thou couldst answer 'This fair child of mine</span>
<span class="s2">Shall sum my count, and make my old excuse,'</span>
<span class="s2">Proving his beauty by succession thine!</span>
<span class="s2">This were to be new made when thou art old,</span>
<span class="s2">And see thy blood warm when thou feel'st it cold."""</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="c1"># we should tokenize the input, but we will ignore that for now</span>
<span class="c1"># build a list of tuples.  Each tuple is ([ word_i-2, word_i-1 ], target word)</span>
<span class="n">trigrams</span> <span class="o">=</span> <span class="p">[([</span><span class="n">test_sentence</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test_sentence</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">test_sentence</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_sentence</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)]</span>
<span class="c1"># print the first 3, just so you can see what they look like</span>
<span class="k">print</span><span class="p">(</span><span class="n">trigrams</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span>

<span class="n">vocab</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">test_sentence</span><span class="p">)</span>
<span class="n">word_to_ix</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vocab</span><span class="p">)}</span>


<span class="k">class</span> <span class="nc">NGramLanguageModeler</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">,</span> <span class="n">context_size</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NGramLanguageModeler</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">embedding_dim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">context_size</span> <span class="o">*</span> <span class="n">embedding_dim</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linear2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">embeds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">embeddings</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linear1</span><span class="p">(</span><span class="n">embeds</span><span class="p">))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear2</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="n">log_probs</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">log_softmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">log_probs</span>


<span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">loss_function</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">NLLLoss</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NGramLanguageModeler</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">),</span> <span class="n">EMBEDDING_DIM</span><span class="p">,</span> <span class="n">CONTEXT_SIZE</span><span class="p">)</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">total_loss</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">context</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="n">trigrams</span><span class="p">:</span>

        <span class="c1"># Step 1. Prepare the inputs to be passed to the model (i.e, turn the words</span>
        <span class="c1"># into integer indices and wrap them in tensors)</span>
        <span class="n">context_idxs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">word_to_ix</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">context</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>

        <span class="c1"># Step 2. Recall that torch *accumulates* gradients. Before passing in a</span>
        <span class="c1"># new instance, you need to zero out the gradients from the old</span>
        <span class="c1"># instance</span>
        <span class="n">model</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

        <span class="c1"># Step 3. Run the forward pass, getting log probabilities over next</span>
        <span class="c1"># words</span>
        <span class="n">log_probs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">context_idxs</span><span class="p">)</span>

        <span class="c1"># Step 4. Compute your loss function. (Again, Torch wants the target</span>
        <span class="c1"># word wrapped in a tensor)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_function</span><span class="p">(</span><span class="n">log_probs</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="n">word_to_ix</span><span class="p">[</span><span class="n">target</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">))</span>

        <span class="c1"># Step 5. Do the backward pass and update the gradient</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="c1"># Get the Python number from a 1-element Tensor by calling tensor.item()</span>
        <span class="n">total_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">total_loss</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>  <span class="c1"># The loss decreased every iteration over the training data!</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[(['When', 'forty'], 'winters'), (['forty', 'winters'], 'shall'), (['winters', 'shall'], 'besiege')]
[525.8425431251526, 523.1689834594727, 520.5158002376556, 517.8828368186951, 515.2689714431763, 512.6738426685333, 510.0945701599121, 507.53167033195496, 504.98349833488464, 502.45050263404846]
</pre></div>
</div>
</div>
<div class="section" id="exercise-computing-word-embeddings-continuous-bag-of-words">
<h2>Exercise: Computing Word Embeddings: Continuous Bag-of-Words<a class="anchorjs-link " href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#exercise-computing-word-embeddings-continuous-bag-of-words" aria-label="Anchor" data-anchorjs-icon="" style="font: 1em/1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>The Continuous Bag-of-Words model (CBOW) is frequently used in NLP deep
learning. It is a model that tries to predict words given the context of
a few words before and a few words after the target word. This is
distinct from language modeling, since CBOW is not sequential and does
not have to be probabilistic. Typcially, CBOW is used to quickly train
word embeddings, and these embeddings are used to initialize the
embeddings of some more complicated model. Usually, this is referred to
as <em>pretraining embeddings</em>. It almost always helps performance a couple
of percent.</p>
<p>The CBOW model is as follows. Given a target word <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-236" style="width: 0.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.088em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.328em, 1001.09em, 2.891em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-237"><span class="msubsup" id="MathJax-Span-238"><span style="display: inline-block; position: relative; width: 1.088em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.72em; left: 0.727em;"><span class="mi" id="MathJax-Span-240" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-18">w_i</script></span> and an
<span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-241" style="width: 0.487em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.968em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.088em, 1000.97em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-242"><span class="mi" id="MathJax-Span-243" style="font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.126em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">N</script></span> context window on each side, <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-244" style="width: 3.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.097em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.328em, 1007.1em, 2.891em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-245"><span class="msubsup" id="MathJax-Span-246"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.72em; left: 0.727em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-251" style="font-size: 96.2%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-252" style="font-size: 96.2%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-253" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main; padding-left: 0.126em;">…</span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main; padding-left: 0.126em;">,</span><span class="msubsup" id="MathJax-Span-256" style="padding-left: 0.126em;"><span style="display: inline-block; position: relative; width: 2.77em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.727em;"><span class="texatom" id="MathJax-Span-258"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-261" style="font-size: 96.2%; font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-262" style="font-size: 96.2%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.126em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>−</mo><mi>N</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-20">w_{i-1}, \dots, w_{i-N}</script></span>
and <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-263" style="width: 3.732em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.097em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.328em, 1007.1em, 2.891em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-264"><span class="msubsup" id="MathJax-Span-265"><span style="display: inline-block; position: relative; width: 2.41em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.72em; left: 0.727em;"><span class="texatom" id="MathJax-Span-267"><span class="mrow" id="MathJax-Span-268"><span class="mi" id="MathJax-Span-269" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-270" style="font-size: 96.2%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-271" style="font-size: 96.2%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-272" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main; padding-left: 0.126em;">…</span><span class="mo" id="MathJax-Span-274" style="font-family: MathJax_Main; padding-left: 0.126em;">,</span><span class="msubsup" id="MathJax-Span-275" style="padding-left: 0.126em;"><span style="display: inline-block; position: relative; width: 2.77em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.6em; left: 0.727em;"><span class="texatom" id="MathJax-Span-277"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-280" style="font-size: 96.2%; font-family: MathJax_Main;">+</span><span class="mi" id="MathJax-Span-281" style="font-size: 96.2%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.126em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>+</mo><mi>N</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">w_{i+1}, \dots, w_{i+N}</script></span>, referring to all context words
collectively as <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-282" style="width: 0.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.088em, 1000.73em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">C</script></span>, CBOW tries to minimize</p>
<div class="math notranslate nohighlight">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mtext&gt;Softmax&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;munder&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;/munder&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-285" style="width: 11.064em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.16em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(0.968em, 1021.04em, 4.093em, -999.994em); top: -2.278em; left: 0em;"><span class="mrow" id="MathJax-Span-286"><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">−</span><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Main; padding-left: 0.126em;">log</span><span class="mo" id="MathJax-Span-289"></span><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Math-italic; padding-left: 0.126em;">p</span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-292"><span style="display: inline-block; position: relative; width: 1.088em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.73em, 4.333em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.72em; left: 0.727em;"><span class="mi" id="MathJax-Span-294" style="font-size: 96.2%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="texatom" id="MathJax-Span-295"><span class="mrow" id="MathJax-Span-296"><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-299" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-300" style="font-family: MathJax_Main; padding-left: 0.246em;">=</span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main; padding-left: 0.246em;">−</span><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Main; padding-left: 0.126em;">log</span><span class="mo" id="MathJax-Span-303"></span><span class="mtext" id="MathJax-Span-304" style="font-family: MathJax_Main; padding-left: 0.126em;">Softmax</span><span class="mo" id="MathJax-Span-305" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-306" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-307" style="font-family: MathJax_Main;">(</span><span class="munderover" id="MathJax-Span-308"><span style="display: inline-block; position: relative; width: 2.049em; height: 0px;"><span style="position: absolute; clip: rect(2.65em, 1001.45em, 4.814em, -999.994em); top: -3.96em; left: 0.367em;"><span class="mo" id="MathJax-Span-309" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; clip: rect(2.891em, 1002.05em, 4.453em, -999.994em); top: -2.638em; left: 0em;"><span class="texatom" id="MathJax-Span-310"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-size: 96.2%; font-family: MathJax_Math-italic;">w</span><span class="mo" id="MathJax-Span-313" style="font-size: 96.2%; font-family: MathJax_Main;">∈</span><span class="mi" id="MathJax-Span-314" style="font-size: 96.2%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-315" style="padding-left: 0.126em;"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.487em;"><span class="mi" id="MathJax-Span-317" style="font-size: 96.2%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span><span class="mo" id="MathJax-Span-318" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main; padding-left: 0.246em;">+</span><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math-italic; padding-left: 0.246em;">b</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.29em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.809em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mo>−</mo><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mi>i</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>C</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>log</mi><mo>⁡</mo><mtext>Softmax</mtext><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">(</mo><munder><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>w</mi><mo>∈</mo><mi>C</mi></mrow></munder><msub><mi>q</mi><mi>w</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">-\log p(w_i | C) = -\log \text{Softmax}(A(\sum_{w \in C} q_w) + b)</script></div>
<p>where <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-322" style="width: 0.607em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.328em, 1001.21em, 2.77em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-323"><span class="msubsup" id="MathJax-Span-324"><span style="display: inline-block; position: relative; width: 1.208em; height: 0px;"><span style="position: absolute; clip: rect(3.131em, 1000.49em, 4.573em, -999.994em); top: -3.96em; left: 0em;"><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span><span style="position: absolute; top: -3.84em; left: 0.487em;"><span class="mi" id="MathJax-Span-326" style="font-size: 96.2%; font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 3.972em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 0.441em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>q</mi><mi>w</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">q_w</script></span> is the embedding for word <span class="math notranslate nohighlight"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-327" style="width: 0.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.727em; height: 0px; font-size: 52%;"><span style="position: absolute; clip: rect(1.328em, 1000.73em, 2.53em, -999.994em); top: -2.157em; left: 0em;"><span class="mrow" id="MathJax-Span-328"><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math-italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.169em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">w</script></span>.</p>
<p>Implement this model in Pytorch by filling in the class below. Some
tips:</p>
<ul class="simple">
<li>Think about which parameters you need to define.</li>
<li>Make sure you know what shape each operation expects. Use .view() if you need to
reshape.</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CONTEXT_SIZE</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># 2 words to the left, 2 to the right</span>
<span class="n">raw_text</span> <span class="o">=</span> <span class="s2">"""We are about to study the idea of a computational process.</span>
<span class="s2">Computational processes are abstract beings that inhabit computers.</span>
<span class="s2">As they evolve, processes manipulate other abstract things called data.</span>
<span class="s2">The evolution of a process is directed by a pattern of rules</span>
<span class="s2">called a program. People create programs to direct processes. In effect,</span>
<span class="s2">we conjure the spirits of the computer with our spells."""</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="c1"># By deriving a set from `raw_text`, we deduplicate the array</span>
<span class="n">vocab</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">raw_text</span><span class="p">)</span>
<span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>

<span class="n">word_to_ix</span> <span class="o">=</span> <span class="p">{</span><span class="n">word</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vocab</span><span class="p">)}</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw_text</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">[</span><span class="n">raw_text</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">2</span><span class="p">],</span> <span class="n">raw_text</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
               <span class="n">raw_text</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">raw_text</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]]</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">raw_text</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">context</span><span class="p">,</span> <span class="n">target</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">CBOW</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="k">pass</span>

<span class="c1"># create your model and train.  here are some functions to help you make</span>
<span class="c1"># the data ready for use by your module</span>


<span class="k">def</span> <span class="nf">make_context_vector</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">word_to_ix</span><span class="p">):</span>
    <span class="n">idxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">word_to_ix</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">context</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">idxs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">)</span>


<span class="n">make_context_vector</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">word_to_ix</span><span class="p">)</span>  <span class="c1"># example</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[(['We', 'are', 'to', 'study'], 'about'), (['are', 'about', 'study', 'the'], 'to'), (['about', 'to', 'the', 'idea'], 'study'), (['to', 'study', 'idea', 'of'], 'the'), (['study', 'the', 'of', 'a'], 'idea')]
</pre></div>
</div>
<p><strong>Total running time of the script:</strong> ( 0 minutes  4.017 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-beginner-nlp-word-embeddings-tutorial-py">
<div class="sphx-glr-download docutils container">
<a class="reference download internal has-code" download="" href="https://pytorch.org/tutorials/_downloads/8807094f6210189fde9923211274dc82/word_embeddings_tutorial.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">word_embeddings_tutorial.py</span></code></a></div>
<div class="sphx-glr-download docutils container">
<a class="reference download internal has-code" download="" href="https://pytorch.org/tutorials/_downloads/e6a250a908acf3362a7ae511adf55881/word_embeddings_tutorial.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">word_embeddings_tutorial.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.readthedocs.io/">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>
</article>
</div>
<footer>
<div aria-label="footer navigation" class="rst-footer-buttons" role="navigation">
<a accesskey="n" class="btn btn-neutral float-right" href="https://pytorch.org/tutorials/beginner/nlp/sequence_models_tutorial.html" rel="next" title="Sequence Models and Long-Short Term Memory Networks">Next <img class="next-page" src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/chevron-right-orange.svg"></a>
<a accesskey="p" class="btn btn-neutral" href="https://pytorch.org/tutorials/beginner/nlp/deep_learning_tutorial.html" rel="prev" title="Deep Learning with PyTorch"><img class="previous-page" src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/chevron-right-orange.svg"> Previous</a>
</div>
<hr>
<div role="contentinfo">
<p>
        © Copyright 2017, PyTorch.

    </p>
</div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org/">Read the Docs</a>. 

</footer>
</div>
</div>
<div class="pytorch-content-right" id="pytorch-content-right" style="height: 100%;">
<div class="pytorch-right-menu" id="pytorch-right-menu" style="top: 0px;">
<div class="pytorch-side-scroll" id="pytorch-side-scroll-right" style="height: 677px;">
<ul>
<li><a class="reference internal title-link has-children" href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#">Word Embeddings: Encoding Lexical Semantics</a><ul>
<li><a class="reference internal" href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#getting-dense-word-embeddings">Getting Dense Word Embeddings</a></li>
<li><a class="reference internal" href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#word-embeddings-in-pytorch">Word Embeddings in Pytorch</a></li>
<li><a class="reference internal" href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#an-example-n-gram-language-modeling">An Example: N-Gram Language Modeling</a></li>
<li><a class="reference internal" href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#exercise-computing-word-embeddings-continuous-bag-of-words">Exercise: Computing Word Embeddings: Continuous Bag-of-Words</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</section>
</div>
<script data-url_root="../../" id="documentation_options" src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/documentation_options.js.下载" type="text/javascript"></script>
<script src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/jquery.js.下载" type="text/javascript"></script>
<script src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/underscore.js.下载" type="text/javascript"></script>
<script src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/doctools.js.下载" type="text/javascript"></script>
<script async="async" src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/MathJax.js.下载" type="text/javascript"></script>
<script src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/popper.min.js.下载" type="text/javascript"></script>
<script src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/bootstrap.min.js.下载" type="text/javascript"></script>
<script src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/theme.js.下载" type="text/javascript"></script>
<script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-90545585-2', 'auto');
  ga('send', 'pageview');

</script>
<img alt="" height="1" src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/saved_resource" style="border-style:none;" width="1">
<!-- Begin Footer -->
<div class="container-fluid docs-tutorials-resources" id="docs-tutorials-resources">
<div class="container">
<div class="row">
<div class="col-md-4 text-center">
<h2>Docs</h2>
<p>Access comprehensive developer documentation for PyTorch</p>
<a class="with-right-arrow" href="https://pytorch.org/docs/stable/index.html">View Docs</a>
</div>
<div class="col-md-4 text-center">
<h2>Tutorials</h2>
<p>Get in-depth tutorials for beginners and advanced developers</p>
<a class="with-right-arrow" href="https://pytorch.org/tutorials">View Tutorials</a>
</div>
<div class="col-md-4 text-center">
<h2>Resources</h2>
<p>Find development resources and get your questions answered</p>
<a class="with-right-arrow" href="https://pytorch.org/resources">View Resources</a>
</div>
</div>
</div>
</div>
<footer class="site-footer">
<div class="container footer-container">
<div class="footer-logo-wrapper">
<a class="footer-logo" href="https://pytorch.org/"></a>
</div>
<div class="footer-links-wrapper">
<div class="footer-links-col">
<ul>
<li class="list-title"><a href="https://pytorch.org/">PyTorch</a></li>
<li><a href="https://pytorch.org/get-started">Get Started</a></li>
<li><a href="https://pytorch.org/features">Features</a></li>
<li><a href="https://pytorch.org/ecosystem">Ecosystem</a></li>
<li><a href="https://pytorch.org/blog/">Blog</a></li>
<li><a href="https://pytorch.org/resources">Resources</a></li>
</ul>
</div>
<div class="footer-links-col">
<ul>
<li class="list-title"><a href="https://pytorch.org/support">Support</a></li>
<li><a href="https://pytorch.org/tutorials">Tutorials</a></li>
<li><a href="https://pytorch.org/docs/stable/index.html">Docs</a></li>
<li><a href="https://discuss.pytorch.org/" target="_blank">Discuss</a></li>
<li><a href="https://github.com/pytorch/pytorch/issues" target="_blank">Github Issues</a></li>
<li><a href="https://pytorch.slack.com/" target="_blank">Slack</a></li>
<li><a href="https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
</ul>
</div>
<div class="footer-links-col follow-us-col">
<ul>
<li class="list-title">Follow Us</li>
<li>
<div id="mc_embed_signup">
<form action="https://twitter.us14.list-manage.com/subscribe/post?u=75419c71fe0a935e53dfa4a3f&amp;id=91d0dccd39" class="email-subscribe-form validate" id="mc-embedded-subscribe-form" method="post" name="mc-embedded-subscribe-form" novalidate="" target="_blank">
<div class="email-subscribe-form-fields-wrapper" id="mc_embed_signup_scroll">
<div class="mc-field-group">
<label for="mce-EMAIL" style="display:none;">Email Address</label>
<input class="required email" id="mce-EMAIL" name="EMAIL" placeholder="Email Address" type="email" value="">
</div>
<div class="clear" id="mce-responses">
<div class="response" id="mce-error-response" style="display:none"></div>
<div class="response" id="mce-success-response" style="display:none"></div>
</div> <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
<div aria-hidden="true" style="position: absolute; left: -5000px;"><input name="b_75419c71fe0a935e53dfa4a3f_91d0dccd39" tabindex="-1" type="text" value=""></div>
<div class="clear">
<input class="button email-subscribe-button" id="mc-embedded-subscribe" name="subscribe" type="submit" value="">
</div>
</div>
</form>
</div>
</li>
</ul>
<div class="footer-social-icons">
<a class="facebook" href="https://www.facebook.com/pytorch" target="_blank"></a>
<a class="twitter" href="https://twitter.com/pytorch" target="_blank"></a>
</div>
</div>
</div>
</div>
</footer>
<!-- End Footer -->
<!-- Begin Mobile Menu -->
<div class="mobile-main-menu">
<div class="container-fluid">
<div class="container">
<div class="mobile-main-menu-header-container">
<a aria-label="PyTorch" class="header-logo" href="https://pytorch.org/"></a>
<a class="main-menu-close-button" data-behavior="close-mobile-menu" href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#"></a>
</div>
</div>
</div>
<div class="mobile-main-menu-links-container">
<div class="main-menu">
<ul>
<li>
<a href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#">Get Started</a>
</li>
<li>
<a href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#">Features</a>
</li>
<li>
<a href="https://pytorch.org/tutorials/beginner/nlp/word_embeddings_tutorial.html#">Ecosystem</a>
</li>
<li>
<a href="https://pytorch.org/blog/">Blog</a>
</li>
<li class="active">
<a href="https://pytorch.org/tutorials">Tutorials</a>
</li>
<li>
<a href="https://pytorch.org/docs/stable/index.html">Docs</a>
</li>
<li>
<a href="https://pytorch.org/resources">Resources</a>
</li>
<li>
<a href="https://github.com/pytorch/pytorch">Github</a>
</li>
</ul>
</div>
</div>
</div>
<!-- End Mobile Menu -->
<script src="./Word Embeddings_ Encoding Lexical Semantics — PyTorch Tutorials 1.0.0.dev20181207 documentation_files/anchor.min.js.下载" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      pytorchAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.pytorch-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size2, sans-serif;"></div></div></body></html>